--Project : Dummy Data SQL Analysis
--Deskripsi : Query untuk latihan SQL dengan dataset dummy customers & orders

select * from customers;
select * from orders;

--Soal 1 : Tampilkan nama customer dan jumlah order customer--
select c.customer_name, count(order_id) from customers c
left join orders o on c.customer_id = o.customer_id
group by c.customer_name;

--Soal 2 : Hitung total belanja percustomer dan urutkan dari yang paling besar
select c.customer_name, sum(o.amount) as total_spending from customers c
left join orders o on c.customer_id = o.customer_id
group by c.customer_name
order by total_spending desc;

--Soal 3 : Untuk setiap kota tampilkan total order dan total revenue
select c.city, count(o.order_id) as total_order, sum(o.amount) as total_revenue from customers c
left join orders o on c.customer_id = o.customer_id
group by c.city
order by total_revenue desc;

--Soal 4 : Hitung payment method yang sering dipakai
select payment_method, count(payment_method) as fav_payment from orders
group by payment_method
order by fav_payment desc;

--Soal 5 : tampilkan customer yang belum pernah order sama sekali
select c.customer_id, c.customer_name from customers c
left join orders o on c.customer_id = o.customer_id
where o.order_id is Null;